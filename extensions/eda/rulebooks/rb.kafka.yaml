- name: Kafka Event Listener
  hosts: localhost
  execution_strategy: parallel
  sources:
    - mancubus77.events.kafka_enhanced:
        host: "my-cluster-kafka-bootstrap.kafka.svc.cluster.local"
        port: 9092
        topic: my-topic
        check_hostname: false

  rules:
    - name: Print Rule
      condition:
        all:
          - events.webhook << event.webhook.payload.url == "http://www.example.com"
          - events.kafka << event.kafka.message.channel == "red"
      action:
        print_event:
          pretty: true
          var_root: i
